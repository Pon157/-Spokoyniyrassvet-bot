<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Админ Панель - Чат Система</title>
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/modern.css">
    <link rel="stylesheet" href="css/admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="admin-container">
        <!-- Header -->
        <header class="admin-header glass-effect">
            <div class="header-content">
                <div class="header-left">
                    <div class="logo">
                        <i class="fas fa-shield-alt"></i>
                        <span>Admin Panel</span>
                    </div>
                    <nav class="admin-nav">
                        <button class="nav-btn active" data-tab="dashboard">
                            <i class="fas fa-chart-bar"></i>
                            <span>Дашборд</span>
                        </button>
                        <button class="nav-btn" data-tab="users">
                            <i class="fas fa-users"></i>
                            <span>Пользователи</span>
                        </button>
                        <button class="nav-btn" data-tab="chats">
                            <i class="fas fa-comments"></i>
                            <span>Чаты</span>
                        </button>
                        <button class="nav-btn" data-tab="moderation">
                            <i class="fas fa-gavel"></i>
                            <span>Модерация</span>
                        </button>
                        <button class="nav-btn" data-tab="logs">
                            <i class="fas fa-clipboard-list"></i>
                            <span>Логи</span>
                        </button>
                    </nav>
                </div>
                <div class="header-right">
                    <div class="user-menu">
                        <img src="images/default-avatar.svg" alt="Avatar" class="avatar-sm">
                        <span id="adminName">Администратор</span>
                        <div class="dropdown">
                            <button class="btn btn-sm btn-secondary" onclick="window.location.href='settings.html'">
                                <i class="fas fa-cog"></i> Настройки
                            </button>
                            <button class="btn btn-sm btn-secondary" onclick="admin.logout()">
                                <i class="fas fa-sign-out-alt"></i> Выход
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="admin-main">
            <!-- Дашборд -->
            <div class="tab-content active" id="dashboardTab">
                <div class="dashboard-header">
                    <h1>Обзор системы</h1>
                    <p>Статистика и мониторинг активности</p>
                </div>

                <!-- Статистика -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon users">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-number" id="totalUsers">0</div>
                            <div class="stat-label">Пользователей</div>
                        </div>
                        <div class="stat-trend up">
                            <i class="fas fa-arrow-up"></i>
                            <span>12%</span>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon listeners">
                            <i class="fas fa-headphones"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-number" id="totalListeners">0</div>
                            <div class="stat-label">Слушателей</div>
                        </div>
                        <div class="stat-trend up">
                            <i class="fas fa-arrow-up"></i>
                            <span>8%</span>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon chats">
                            <i class="fas fa-comments"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-number" id="totalChats">0</div>
                            <div class="stat-label">Активных чатов</div>
                        </div>
                        <div class="stat-trend up">
                            <i class="fas fa-arrow-up"></i>
                            <span>15%</span>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon messages">
                            <i class="fas fa-envelope"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-number" id="totalMessages">0</div>
                            <div class="stat-label">Сообщений сегодня</div>
                        </div>
                        <div class="stat-trend up">
                            <i class="fas fa-arrow-up"></i>
                            <span>23%</span>
                        </div>
                    </div>
                </div>

                <!-- Графики и таблицы -->
                <div class="dashboard-grid">
                    <div class="card chart-card">
                        <div class="card-header">
                            <h3>Активность по часам</h3>
                            <select id="activityPeriod">
                                <option value="today">Сегодня</option>
                                <option value="week">Неделя</option>
                                <option value="month">Месяц</option>
                            </select>
                        </div>
                        <div class="card-body">
                            <div class="chart-placeholder" id="activityChart">
                                <div class="chart-bars">
                                    <div class="bar" style="height: 30%"></div>
                                    <div class="bar" style="height: 45%"></div>
                                    <div class="bar" style="height: 60%"></div>
                                    <div class="bar" style="height: 80%"></div>
                                    <div class="bar" style="height: 95%"></div>
                                    <div class="bar" style="height: 75%"></div>
                                    <div class="bar" style="height: 50%"></div>
                                </div>
                                <div class="chart-labels">
                                    <span>9:00</span><span>12:00</span><span>15:00</span><span>18:00</span>
                                    <span>21:00</span><span>00:00</span><span>3:00</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card recent-activity">
                        <div class="card-header">
                            <h3>Последние действия</h3>
                            <button class="btn btn-sm btn-secondary" onclick="admin.loadActivity()">
                                <i class="fas fa-sync"></i>
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="activity-list" id="activityList">
                                <!-- Активность загружается здесь -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Пользователи -->
            <div class="tab-content" id="usersTab">
                <div class="section-header">
                    <h2>Управление пользователями</h2>
                    <div class="header-actions">
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" placeholder="Поиск пользователей..." id="userSearch">
                        </div>
                        <button class="btn btn-primary" onclick="admin.exportUsers()">
                            <i class="fas fa-download"></i> Экспорт
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Пользователь</th>
                                    <th>Роль</th>
                                    <th>Статус</th>
                                    <th>Активность</th>
                                    <th>Регистрация</th>
                                    <th>Действия</th>
                                </tr>
                            </thead>
                            <tbody id="usersTable">
                                <!-- Пользователи загружаются здесь -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Чаты -->
            <div class="tab-content" id="chatsTab">
                <div class="section-header">
                    <h2>Мониторинг чатов</h2>
                    <div class="header-actions">
                        <button class="btn btn-secondary" onclick="admin.loadChats()">
                            <i class="fas fa-sync"></i> Обновить
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID Чата</th>
                                    <th>Пользователь</th>
                                    <th>Слушатель</th>
                                    <th>Статус</th>
                                    <th>Сообщений</th>
                                    <th>Создан</th>
                                    <th>Действия</th>
                                </tr>
                            </thead>
                            <tbody id="chatsTable">
                                <!-- Чаты загружаются здесь -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Модерация -->
            <div class="tab-content" id="moderationTab">
                <div class="section-header">
                    <h2>Быстрая модерация</h2>
                </div>

                <div class="moderation-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-ban"></i> Блокировка пользователя</h3>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label>Выберите пользователя:</label>
                                <select id="blockUserSelect" class="form-select">
                                    <option value="">-- Выберите пользователя --</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Причина блокировки:</label>
                                <textarea id="blockReason" placeholder="Опишите причину блокировки..." rows="3"></textarea>
                            </div>
                            <button class="btn btn-danger btn-block" onclick="admin.blockUser()">
                                <i class="fas fa-ban"></i> Заблокировать пользователя
                            </button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-volume-mute"></i> Мут пользователя</h3>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label>Выберите пользователя:</label>
                                <select id="muteUserSelect" class="form-select">
                                    <option value="">-- Выберите пользователя --</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Длительность:</label>
                                <select id="muteDuration" class="form-select">
                                    <option value="60">1 час</option>
                                    <option value="360">6 часов</option>
                                    <option value="1440">24 часа</option>
                                    <option value="10080">7 дней</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Причина:</label>
                                <input type="text" id="muteReason" placeholder="Причина мута">
                            </div>
                            <button class="btn btn-warning btn-block" onclick="admin.muteUser()">
                                <i class="fas fa-volume-mute"></i> Замутить пользователя
                            </button>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-exclamation-triangle"></i> Активные блокировки и муты</h3>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Пользователь</th>
                                        <th>Тип</th>
                                        <th>Причина</th>
                                        <th>Истекает</th>
                                        <th>Действия</th>
                                    </tr>
                                </thead>
                                <tbody id="moderationTable">
                                    <!-- Активные модерационные действия -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Логи -->
            <div class="tab-content" id="logsTab">
                <div class="section-header">
                    <h2>Системные логи</h2>
                    <div class="header-actions">
                        <div class="filters">
                            <select id="logTypeFilter">
                                <option value="">Все действия</option>
                                <option value="LOGIN">Вход</option>
                                <option value="REGISTER">Регистрация</option>
                                <option value="MESSAGE_SEND">Сообщения</option>
                                <option value="MODERATION">Модерация</option>
                            </select>
                            <input type="date" id="logDateFilter">
                            <button class="btn btn-secondary" onclick="admin.loadLogs()">
                                <i class="fas fa-filter"></i> Применить
                            </button>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Время</th>
                                    <th>Пользователь</th>
                                    <th>Действие</th>
                                    <th>Детали</th>
                                    <th>IP Адрес</th>
                                </tr>
                            </thead>
                            <tbody id="logsTable">
                                <!-- Логи загружаются здесь -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Модальные окна -->
    <div class="modal" id="userDetailModal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h3>Детали пользователя</h3>
                <button class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <div id="userDetailContent"></div>
            </div>
        </div>
    </div>

    <div class="modal" id="chatViewModal">
        <div class="modal-content modal-xl">
            <div class="modal-header">
                <h3>Просмотр чата</h3>
                <button class="btn-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="chat-view" id="chatViewContent"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="admin.joinChat()">
                    <i class="fas fa-sign-in-alt"></i> Присоединиться к чату
                </button>
            </div>
        </div>
    </div>

    <script src="js/admin.js"></script>
</body>
</html>
